<div class="taches-container">
  <h2>ğŸ“‹ Liste des tÃ¢ches</h2>

  <!-- ğŸ”¥ Bouton rÃ©servÃ© uniquement Ã  lâ€™ADMIN -->
  <a *ngIf="isAdmin"
     routerLink="/taches/create"
     class="create-tache-btn">
    â• CrÃ©er une nouvelle tÃ¢che
  </a>

  <!-- ğŸ” FILTRES / RECHERCHE -->
  <div class="taches-filters">

    <!-- Recherche par mot-clÃ© -->
    <input type="text"
           [(ngModel)]="searchTerm"
           placeholder="Rechercher un mot-clÃ©...">

    <!-- ğŸ”¥ Filtre auteur : ADMIN seulement -->
    <input *ngIf="isAdmin"
           type="text"
           [(ngModel)]="selectedAuteur"
           placeholder="Filtrer par auteur...">

    <!-- Tri -->
    <select [(ngModel)]="sort">
      <option value="date_desc">Date dÃ©croissante</option>
      <option value="date_asc">Date croissante</option>
    </select>

    <button (click)="applyFilters()">Appliquer</button>
  </div>

  <!-- ğŸ§¾ LISTE DES TÃ‚CHES -->
  <ul class="taches-list">

    <li *ngFor="let t of taches">

      <!-- Titre -->
      <a [routerLink]="['/taches', t.id]">
        <strong>{{ t.titre }}</strong>
      </a>

      â€¢ <span [innerHTML]="sanitize(t.contenu)"></span>

      <!-- MÃ©tadonnÃ©es -->
      <div class="taches-meta">

        <!-- ADMIN : voir Ã©quipe + auteur -->
        <span *ngIf="isAdmin">
          (Ã‰quipe : {{ t.equipe || 'â€”' }}) â€”
          Auteur : {{ t.auteur?.nom || 'Inconnu' }}
          <br>
        </span>

        <!-- USER : voir uniquement sa propre Ã©quipe -->
        <span *ngIf="!isAdmin">
          (Votre Ã©quipe : {{ currentUser?.equipe || 'â€”' }})
          <br>
        </span>

        <!-- Dates -->
        ğŸ“… CrÃ©Ã©e le :
        <span class="created">{{ t.created_at | date:'short' }}</span>

        <span *ngIf="t.updated_at" class="updated">
          â€” ModifiÃ©e le : {{ t.updated_at | date:'short' }}
        </span>

        <!-- Fichiers -->
        <span *ngIf="t.fichiers && t.fichiers.length > 0">
          ğŸ“ {{ t.fichiers.length }}
        </span>

      </div>

    </li>

  </ul>

  <!-- ğŸ“„ PAGINATION -->
  <div class="pagination">
    <button [disabled]="page === 1" (click)="goToPage(page - 1)">
      PrÃ©cÃ©dent
    </button>

    <span>Page {{ page }} / {{ totalPages }}</span>

    <button [disabled]="page >= totalPages" (click)="goToPage(page + 1)">
      Suivant
    </button>
  </div>
</div>
